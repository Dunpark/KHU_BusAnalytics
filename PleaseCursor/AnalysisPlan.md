# 서울시 카페 상권 분석 계획서

## 프로젝트 개요

### 목적
서울시 카페 상권의 점포당 매출액 영향 요인을 분석하고, 상권 유형을 분류하여 창업자에게 유의미한 인사이트를 제공한다.

### 데이터
- `df_cafe_20244.csv`: 2024년 4분기 횡단면 데이터
- `df_cafe_timeSeries.csv`: 2021년 1분기 ~ 2024년 4분기 시계열 데이터

### 선행연구 기반 방법론
- **점포당 매출액(SPS)** 사용: 단순 총매출이 아닌 점포당 매출액을 핵심 지표로 활용
- **DTW 기반 시계열 클러스터링**: Dynamic Time Warping을 활용한 상권 유형 분류
- **5가지 상권 유형**: 성장상권, 기대상권, 전통강호상권, 정체상권, 쇠퇴상권

---

## 분석 파이프라인

### Phase 1: 시계열 EDA (`01_TimeSeries_EDA.py`)

#### 1.1 점포당 매출액 계산
```
점포당 매출액 = 당월 매출 금액 / 유사 업종 점포 수
```

#### 1.2 시계열 특성 추출

| 특성명 | 의미 | 수식 |
|--------|------|------|
| sps_mean | 평균 점포당매출 | (점포당_매출액₂₀₂₁₁ + ... + 점포당_매출액₂₀₂₄₄) / 분기수 |
| sps_growth | 4년 성장률 | (점포당_매출액₂₀₂₄₄ - 점포당_매출액₂₀₂₁₁) / 점포당_매출액₂₀₂₁₁ |
| sps_cagr | 연평균 성장률 | (점포당_매출액₂₀₂₄₄ / 점포당_매출액₂₀₂₁₁)^(1/4) - 1 |
| sps_cv | 변동계수 | 표준편차₂₀₂₁₁~₂₀₂₄₄ / 평균₂₀₂₁₁~₂₀₂₄₄ |
| store_growth | 점포수 변화율 | (유사_업종_점포_수₂₀₂₄₄ - 유사_업종_점포_수₂₀₂₁₁) / 유사_업종_점포_수₂₀₂₁₁ |

#### 1.3 출력물
- `df_ts_features.csv`: 상권별 시계열 특성
- `ts_01_sps_trend.png`: 점포당 매출액 추세
- `ts_02_comparison.png`: 총매출 vs 점포당매출 비교
- `ts_03_sps_boxplot.png`: 분기별 분포
- `ts_04_sample_trends.png`: 샘플 상권 시계열
- `ts_05_commercial_types.png`: 상권유형별 특성

---

### Phase 2: DTW 클러스터링 (`01_DTW_Clustering.py`)

#### 2.1 DTW (Dynamic Time Warping) K-means
- 시계열 패턴의 유사성 기반 클러스터링
- 시간축 왜곡을 허용하여 패턴 매칭
- K=5 (5가지 상권 유형)

#### 2.2 상권 유형 정의

| 유형 | 특성 | 전략적 의미 |
|------|------|-------------|
| 성장상권 | 높은 성장률 + 큰 규모 | 검증된 성장 지역, 진입 비용 높음 |
| 기대상권 | 높은 성장률 + 중소 규모 | 잠재력 있는 신흥 상권 |
| 전통강호상권 | 낮은 성장률 + 큰 규모 | 안정적이나 성장 여력 제한 |
| 정체상권 | 낮은 성장률 + 중간 규모 | 전략적 차별화 필요 |
| 쇠퇴상권 | 음의 성장률 | 진입 주의, 철수 고려 |

#### 2.3 출력물
- `df_dtw_clusters.csv`: DTW 클러스터링 결과
- `df_dtw_type_summary.csv`: 유형별 요약 통계
- `dtw_01_clustering_results.png`: 클러스터별 시계열 패턴
- `dtw_02_type_characteristics.png`: 유형별 특성 비교

---

### Phase 3: 횡단면 EDA (`02_CrossSectional_EDA.py`)

#### 3.1 파생변수 생성
- 점포당 매출액, 로그 변환
- 유동인구 대비 상주인구 비율
- 경쟁강도 (만㎡당 점포수)
- 프랜차이즈 비율

#### 3.2 상관관계 분석
- 점포당 매출액과 각 변수 간 상관관계
- 상권유형별 특성 비교
- 자치구별, 상권 구분별 분석

#### 3.3 출력물
- `df_modeling.csv`: 모델링용 데이터
- `cross_01_correlation.png`: 상관관계 히트맵
- `cross_02_type_comparison.png`: 유형별 비교
- `cross_03_gu_ranking.png`: 자치구별 순위
- `cross_04_area_type.png`: 상권 구분별 분석
- `cross_05_distributions.png`: 주요 변수 분포

---

### Phase 4: 모델링 (`03_Modeling.py`)

#### 4.1 OLS 회귀분석
- 종속변수: log(점포당 매출액)
- 독립변수: 유동인구, 상주인구, 소득, 경쟁강도 등
- VIF 기반 다중공선성 검정

#### 4.2 K-means 클러스터링
- 횡단면 변수 기반 클러스터링
- Elbow Method + Silhouette Score로 최적 K 탐색

#### 4.3 분류 모델
- 로지스틱 회귀
- 의사결정나무
- 상권유형 예측

#### 4.4 출력물
- `model_ols_results.csv`: 회귀분석 결과
- `model_vif_results.csv`: VIF 결과
- `model_kmeans_results.csv`: 클러스터링 결과
- `model_classification_results.csv`: 분류 모델 성능
- 각종 시각화 파일

---

### Phase 5: 폐업률 분석 (`analyze_closure_rate.py`)

#### 5.1 폐업률 정의
```
폐업률 = Σ(폐업_점포_수) / Σ(점포_수) × 100
```

**정당성:**
- 가중 평균 효과로 상권 규모 반영
- 업종별 공정한 비교 가능
- 시장 전체 관점의 건전성 평가

#### 5.2 출력물
- `closure_rate_by_industry.csv`: 업종별 폐업률
- `closure_rate_analysis.png`: 시각화

---

## 최종 산출물

### 보고서
- `EDA_TimeSeries_Report.md`: 시계열 EDA 보고서
- `EDA_CrossSectional_Report.md`: 횡단면 EDA 보고서
- `Modeling_Report.md`: 모델링 보고서
- `FinalReport_Complete.md`: 최종 통합 보고서

### 데이터
- 특성 추출 결과 (CSV)
- 클러스터링 결과 (CSV)
- 모델링 결과 (CSV)

### 시각화
- 시계열 분석 차트 (PNG)
- 횡단면 분석 차트 (PNG)
- 모델링 진단 차트 (PNG)

---

## 주의사항

### 1. 허위 성장 (Illusory Growth) 경고
- 점포당 매출액 증가가 반드시 시장 성장을 의미하지 않음
- 점포수 감소로 인한 수치적 증가 가능성 검토 필요
- `store_growth`와 `sps_growth` 함께 해석

### 2. 데이터 한계
- 외부 요인 (코로나, 경기변동) 미반영
- 상권 내 개별 점포 특성 미반영
- 시계열 16개 분기 한정

### 3. 해석 주의
- 상관관계 ≠ 인과관계
- 평균의 함정 주의 (상권 내 편차 존재)
- 동적 시장 특성 고려

